import{d as $,q as c,n as j,A as b,B as L,r as m,o as v,j as M,g as t,w as a,u as o,h as z,c as E,l as g,t as P,E as f}from"./vendor.bd148101.js";import{a as B}from"./api.5520eefe.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";const H={class:"login-page"},J={style:{"text-align":"center"}},K=g("\u767B\u5F55"),O=g("\u53D1\u9001\u9A8C\u8BC1\u7801"),Q={style:{"text-align":"center"}},W=g("\u6CE8\u518C"),X=$({emits:["loginSucc"],setup(Y,{emit:C}){const F=c("first"),D=(n,e)=>{console.log(n,e)},V=c("default"),p=j(),y=c(),k=c(),i=c(60),d=b({username:"",password:""}),s=b({name:"",password:"",mail:"",code:""}),w=b({username:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"}],code:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",trigger:"blur"}],mail:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}]}),R=L();console.log(R);const q=async n=>{!n||await n.validate((e,r)=>{e?B.login(d).then(l=>{l.data&&l.data.data&&(f.success("\u767B\u5F55\u6210\u529F"),localStorage.setItem("token",l.data.data.token),p.commit("loginSucc",l.data.data.token),p.commit("setUser",d.username),localStorage.setItem("username",d.username),C("loginSucc"))}):console.log("error submit!",r)})},I=async n=>{!n||await n.validate((e,r)=>{e?B.register(s).then(l=>{l.data.code==200?(f.success("\u6CE8\u518C\u6210\u529F"),localStorage.setItem("token",l.data.data.token),p.commit("loginSucc",l.data.data.token),p.commit("setUser",s.name),localStorage.setItem("username",s.name),C("loginSucc")):f.error(l.data.msg)}):console.log("error submit!",r)})},S=()=>{i.value>0?(i.value--,setTimeout(S,1e3)):i.value=60},N=()=>{/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(s.mail)?(S(),B.sendCode({email:s.mail}).then(e=>{})):f("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1")};return(n,e)=>{const r=m("el-input"),l=m("el-form-item"),_=m("el-button"),x=m("el-form"),A=m("el-tab-pane"),U=m("el-col"),T=m("el-row"),Z=m("el-tabs");return v(),M("div",H,[t(Z,{modelValue:F.value,"onUpdate:modelValue":e[8]||(e[8]=u=>F.value=u),type:"card",class:"demo-tabs",onTabClick:D},{default:a(()=>[t(A,{label:"\u767B\u5F55",name:"first"},{default:a(()=>[t(x,{ref_key:"ruleFormRef",ref:y,model:o(d),rules:o(w),"label-width":"80px",class:"login-form",size:V.value},{default:a(()=>[t(l,{label:"\u8D26\u6237",prop:"username"},{default:a(()=>[t(r,{modelValue:o(d).username,"onUpdate:modelValue":e[0]||(e[0]=u=>o(d).username=u)},null,8,["modelValue"])]),_:1}),t(l,{label:"\u5BC6\u7801",prop:"password"},{default:a(()=>[t(r,{modelValue:o(d).password,"onUpdate:modelValue":e[1]||(e[1]=u=>o(d).password=u)},null,8,["modelValue"])]),_:1}),z("div",J,[t(_,{type:"primary",onClick:e[2]||(e[2]=u=>q(y.value))},{default:a(()=>[K]),_:1})])]),_:1},8,["model","rules","size"])]),_:1}),t(A,{label:"\u6CE8\u518C",name:"second"},{default:a(()=>[t(x,{ref_key:"registFormRef",ref:k,model:o(s),rules:o(w),"label-width":"80px",class:"login-form",size:V.value},{default:a(()=>[t(l,{label:"\u8D26\u6237",prop:"name"},{default:a(()=>[t(r,{modelValue:o(s).name,"onUpdate:modelValue":e[3]||(e[3]=u=>o(s).name=u)},null,8,["modelValue"])]),_:1}),t(l,{label:"\u5BC6\u7801",prop:"password"},{default:a(()=>[t(r,{modelValue:o(s).password,"onUpdate:modelValue":e[4]||(e[4]=u=>o(s).password=u)},null,8,["modelValue"])]),_:1}),t(l,{label:"\u90AE\u7BB1",prop:"mail"},{default:a(()=>[t(r,{modelValue:o(s).mail,"onUpdate:modelValue":e[5]||(e[5]=u=>o(s).mail=u)},null,8,["modelValue"])]),_:1}),t(l,{label:"\u9A8C\u8BC1\u7801",prop:"code"},{default:a(()=>[t(T,{gutter:20},{default:a(()=>[t(U,{span:12},{default:a(()=>[t(r,{modelValue:o(s).code,"onUpdate:modelValue":e[6]||(e[6]=u=>o(s).code=u)},null,8,["modelValue"])]),_:1}),t(U,{span:12,style:{"text-align":"right"}},{default:a(()=>[i.value>0&&i.value<60?(v(),E(_,{key:0,disabled:""},{default:a(()=>[g(P(i.value)+"\u79D2",1)]),_:1})):(v(),E(_,{key:1,onClick:N,type:"primary"},{default:a(()=>[O]),_:1}))]),_:1})]),_:1})]),_:1}),z("div",Q,[t(_,{type:"primary",onClick:e[7]||(e[7]=u=>I(k.value))},{default:a(()=>[W]),_:1})])]),_:1},8,["model","rules","size"])]),_:1})]),_:1},8,["modelValue"])])}}});var ae=G(X,[["__scopeId","data-v-4d5a5550"]]);export{ae as default};
