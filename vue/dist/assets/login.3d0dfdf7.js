import{d as $,q as c,n as j,B as b,C as L,r as m,o as v,j as M,g as a,w as l,u as o,h as z,c as E,l as f,t as P,E as g}from"./vendor.a333fa72.js";import{a as B}from"./api.60e2c8bc.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";const H={class:"login-page"},J={style:{"text-align":"center"}},K=f("\u767B\u5F55"),O=f("\u53D1\u9001\u9A8C\u8BC1\u7801"),Q={style:{"text-align":"center"}},W=f("\u6CE8\u518C"),X=$({emits:["loginSucc"],setup(Y,{emit:C}){const F=c("first"),D=(r,e)=>{console.log(r,e)},V=c("default"),_=j(),y=c(),k=c(),i=c(60),d=b({username:"",password:""}),s=b({name:"",password:"",mail:"",code:""}),w=b({username:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"}],code:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",trigger:"blur"}],mail:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}]}),I=L();console.log(I);const R=async r=>{!r||await r.validate((e,n)=>{e?B.login(d).then(t=>{t.data&&t.data.data&&(g.success("\u767B\u5F55\u6210\u529F"),localStorage.setItem("token",t.data.data.token),_.commit("loginSucc",t.data.data.token),_.commit("setUser",{username:d.username,is_admin:t.data.data.is_admin}),localStorage.setItem("is_admin",t.data.data.is_admin),localStorage.setItem("username",d.username),C("loginSucc"))}):console.log("error submit!",n)})},q=async r=>{!r||await r.validate((e,n)=>{e?B.register(s).then(t=>{t.data.code==200?(g.success("\u6CE8\u518C\u6210\u529F"),localStorage.setItem("token",t.data.data.token),_.commit("loginSucc",t.data.data.token),_.commit("setUser",{username:s.name,is_admin:t.data.data.is_admin}),localStorage.setItem("username",s.name),localStorage.setItem("is_admin",t.data.data.is_admin),C("loginSucc")):g.error(t.data.msg)}):console.log("error submit!",n)})},S=()=>{i.value>0?(i.value--,setTimeout(S,1e3)):i.value=60},N=()=>{/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(s.mail)?(S(),B.sendCode({email:s.mail}).then(e=>{})):g("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1")};return(r,e)=>{const n=m("el-input"),t=m("el-form-item"),p=m("el-button"),x=m("el-form"),A=m("el-tab-pane"),U=m("el-col"),T=m("el-row"),Z=m("el-tabs");return v(),M("div",H,[a(Z,{modelValue:F.value,"onUpdate:modelValue":e[8]||(e[8]=u=>F.value=u),type:"card",class:"demo-tabs",onTabClick:D},{default:l(()=>[a(A,{label:"\u767B\u5F55",name:"first"},{default:l(()=>[a(x,{ref_key:"ruleFormRef",ref:y,model:o(d),rules:o(w),"label-width":"80px",class:"login-form",size:V.value},{default:l(()=>[a(t,{label:"\u8D26\u6237",prop:"username"},{default:l(()=>[a(n,{modelValue:o(d).username,"onUpdate:modelValue":e[0]||(e[0]=u=>o(d).username=u)},null,8,["modelValue"])]),_:1}),a(t,{label:"\u5BC6\u7801",prop:"password"},{default:l(()=>[a(n,{modelValue:o(d).password,"onUpdate:modelValue":e[1]||(e[1]=u=>o(d).password=u)},null,8,["modelValue"])]),_:1}),z("div",J,[a(p,{type:"primary",onClick:e[2]||(e[2]=u=>R(y.value))},{default:l(()=>[K]),_:1})])]),_:1},8,["model","rules","size"])]),_:1}),a(A,{label:"\u6CE8\u518C",name:"second"},{default:l(()=>[a(x,{ref_key:"registFormRef",ref:k,model:o(s),rules:o(w),"label-width":"80px",class:"login-form",size:V.value},{default:l(()=>[a(t,{label:"\u8D26\u6237",prop:"name"},{default:l(()=>[a(n,{modelValue:o(s).name,"onUpdate:modelValue":e[3]||(e[3]=u=>o(s).name=u)},null,8,["modelValue"])]),_:1}),a(t,{label:"\u5BC6\u7801",prop:"password"},{default:l(()=>[a(n,{modelValue:o(s).password,"onUpdate:modelValue":e[4]||(e[4]=u=>o(s).password=u)},null,8,["modelValue"])]),_:1}),a(t,{label:"\u90AE\u7BB1",prop:"mail"},{default:l(()=>[a(n,{modelValue:o(s).mail,"onUpdate:modelValue":e[5]||(e[5]=u=>o(s).mail=u)},null,8,["modelValue"])]),_:1}),a(t,{label:"\u9A8C\u8BC1\u7801",prop:"code"},{default:l(()=>[a(T,{gutter:20},{default:l(()=>[a(U,{span:12},{default:l(()=>[a(n,{modelValue:o(s).code,"onUpdate:modelValue":e[6]||(e[6]=u=>o(s).code=u)},null,8,["modelValue"])]),_:1}),a(U,{span:12,style:{"text-align":"right"}},{default:l(()=>[i.value>0&&i.value<60?(v(),E(p,{key:0,disabled:""},{default:l(()=>[f(P(i.value)+"\u79D2",1)]),_:1})):(v(),E(p,{key:1,onClick:N,type:"primary"},{default:l(()=>[O]),_:1}))]),_:1})]),_:1})]),_:1}),z("div",Q,[a(p,{type:"primary",onClick:e[7]||(e[7]=u=>q(k.value))},{default:l(()=>[W]),_:1})])]),_:1},8,["model","rules","size"])]),_:1})]),_:1},8,["modelValue"])])}}});var te=G(X,[["__scopeId","data-v-2c2863aa"]]);export{te as default};
